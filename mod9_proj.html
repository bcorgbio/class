<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Module 9 Project</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/sandstone.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 61px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h2 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h3 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h4 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h5 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h6 {
  padding-top: 66px;
  margin-top: -66px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">BIOL 3140</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="schedule.html">Schedule</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Projects
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Phase I</li>
    <li>
      <a href="phaseI_rubric.html">Phase I report rubric</a>
    </li>
    <li>
      <a href="mod1_proj.html">Module 1 Project</a>
    </li>
    <li>
      <a href="mod2_proj.html">Module 2 Project</a>
    </li>
    <li>
      <a href="mod3_proj.html">Module 3 Project</a>
    </li>
    <li>
      <a href="mod4_proj.html">Module 4 Project</a>
    </li>
    <li>
      <a href="mod5_proj.html">Module 5 Project</a>
    </li>
    <li class="dropdown-header">Phase II</li>
    <li>
      <a href="phaseII_rubric.html">Phase II report rubric</a>
    </li>
    <li>
      <a href="mod6_proj.html">Module 6 Project</a>
    </li>
    <li>
      <a href="mod7_proj.html">Module 7 Project</a>
    </li>
    <li>
      <a href="mod8_proj.html">Module 8 Project</a>
    </li>
    <li>
      <a href="mod9_proj.html">Module 9 Project</a>
    </li>
    <li class="dropdown-header">Phase III</li>
    <li>
      <a href="phaseIII_rubric.html">Phase III report rubric</a>
    </li>
    <li>
      <a href="final_proj.html">Final Project</a>
    </li>
    <li class="dropdown-header">DaqPacks</li>
    <li>
      <a href="daqpack.html">DaqPack Item List</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://github.com/orgs/bcorgbio/teams/biol-3140">BIOL 3140 Discussion</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Module 9 Project</h1>

</div>


<style>
div.green { background-color:#c7d1c0; border-radius: 5px; padding: 20px;}
</style>
<!-- Add icon library -->
<p><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"></p>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>Each northern hemisphere spring, many neotropical passerines undertake long-distance migrations from Central and South America to temperate latitudes to forage and breed. Many of these species fly non-stop over the Gulf of Mexico and arrived on land between Texas and Florida. These species are therefore described as trans-Gulf migrants (TGMs). The date when any individual migrant arrives on its breeding grounds has important fitness consequences and the evolution of this phenological event is likely the result of balancing important tradeoffs. For instance, arriving early increases the chances of finding a mate and breeding multiple times, however later arrival ensures higher food availability in these temperate and seasonal ecosystems <span class="citation">(Smith and Moore 2005; Newton 2008)</span>.</p>
<p>In the context of a changing climate, failure of TGMs to shift arrival date at breeding areas in response to warmer spring temperatures may result in population declines <span class="citation">(Both et al. 2006)</span>. If and how TGMs and other long-distance migrants shift their spring arrival in temperate North America in response to local temperature changes remains hotly debated <span class="citation">(Smith and Moore 2005; Knudsen et al. 2011)</span>. In studying the effects of changes in local environmental parameters linked to climate change on migration phenology, scientists have traditionally relied on field, <a href="https://www.fws.gov/faq/bandingfaq.html">banding</a>, or tracking studies <span class="citation">(e.g., Smith and Moore 2005; Askeyev, Sparks, and Askeyev 2009)</span>. These studies are often limited in temporal scope and in scale due to the few experts who are trained in this work</p>
<p>In recent decades, there has been a marked increase in public interest in species conservation. Coupled with this is the development of several online programs in which amateur birders can submit bird observations. The Cornell Laboratory of Ornithology and the National Audubon Society have established the most popular and far-reaching of these programs: <a href="http://www.ebird.org">eBird</a>. Since its launch in 2002, eBird has collected and compiled well over 100 million bird observations from many thousand contributors. In addition to new checklists, users have also entered historical observations, so that eBird includes data prior to 2002 as well. This great cache of data has enormous implications for the study of bird ecology. Although it is a relatively new platform and its temporal reach is limited, the taxonomic and geographic breadth of eBird data will no doubt make it an important tool in studying avian biology.</p>
<p>The goal of this project is to use eBird and meteorological data to study the effect of local weather conditions on the arrival time of TGMs in Massachusetts. To do this, we’ll download eBird’s species occurrence data from the Global Biodiversity Information Facility (GBIF) using <a href="https://www.gbif.org/tool/81747/rgbif"><code>rgif</code></a>, an R package that permits access to GBIF’s application programming interface (API). We’ll also compile weather using another R package, <code>rnoa</code> which contains functions that interact with <a href="https://www.ncdc.noaa.gov/cdo-web/webservices/v2">NOAA’s National Climatic Data Center’s API</a>.</p>
</div>
<div id="methods" class="section level1">
<h1>Methods</h1>
<p>Firstly, you should decide which species to study. We’ll limit this to any 5 in this <a href="tgms.csv">list of TGMs</a> that make their way to MA each spring. Once you have 5 species chosen, download the occurrence data for these species using the <code>occ_data()</code> function from <code>rgbif</code>.</p>
<div class="green">
<div class="row">
<div class="col-sm-2">
<a class="far fa-sticky-note fa-5x" style="color:#939681"></a> <!-- regular style -->
</div>
<div class="col-sm-9">
<p>eBrid does indeed have its own API and R package (two actually, <code>rebird</code> and <code>auk</code>). However, I find them rather cumbersome and hard to work with. <code>auk</code> is especially so in that it requires downloading and filtering through the entire eBird data set when one only wants to work with just a few species. The developers suggest workarounds, however, one may still spend many hours just loading the initial data. Fortunately, eBird sends its data to GBIF and, thus, <code>rgbif</code>, which allows species-level queries to the GBIF API, is much easier to work with. Same data, fewer headaches.</p>
</div>
</div>
</div>
<p><br></p>
<div id="querying-gbifs-api" class="section level2">
<h2>Querying GBIF’s API</h2>
<p>Before we go too much further, let’s have a look at what <code>rgbif</code> can do. Its most promising function for our work is <code>occ_data()</code> which searches GBIF occurrences relatively quickly. Let’s first load the packages we’ll need now and later (make sure they’re installed!). Then, let’s query GBIF for the common raven, a most spectacular bird, in the state of Maine (a most spectacular place) and plot the occurrence lat/lon on a map of that state using <code>ggmap</code> and <code>cowplot</code> functions. Here we restrict the <code>occ_data()</code> search by specifying the scientific name (<em>Corvus corax</em>), the state/province to Maine, the year as 2018, and a limit of 200 records.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(rgbif)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw">library</span>(MuMIn)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="kw">library</span>(rnoaa)</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="kw">library</span>(data.table)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="kw">library</span>(ggmap)</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="kw">library</span>(usmap)</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="kw">library</span>(magick)<span class="co">#for examples</span></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="kw">library</span>(cowplot)<span class="co">#for examples</span></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="kw">library</span>(lme4) <span class="co">#for linear mixed effect models</span></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="kw">library</span>(car) <span class="co">#for LME anova testing</span></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="kw">library</span>(data.table) <span class="co">#for frollmean function (and others)</span></span>
<span id="cb1-13"><a href="#cb1-13"></a></span>
<span id="cb1-14"><a href="#cb1-14"></a>raven &lt;-<span class="st"> </span><span class="kw">occ_data</span>(<span class="dt">scientificName =</span> <span class="st">&quot;Corvus corax&quot;</span>, <span class="dt">stateProvince=</span><span class="st">&quot;Maine&quot;</span>, <span class="dt">limit=</span><span class="dv">200</span>,<span class="dt">year=</span><span class="dv">2018</span>)</span>
<span id="cb1-15"><a href="#cb1-15"></a></span>
<span id="cb1-16"><a href="#cb1-16"></a><span class="co">#get the state of ME from ggmaps map data</span></span>
<span id="cb1-17"><a href="#cb1-17"></a>ME&lt;-<span class="st"> </span><span class="kw">map_data</span>(<span class="st">&#39;state&#39;</span>, <span class="st">&#39;maine&#39;</span>)</span>
<span id="cb1-18"><a href="#cb1-18"></a></span>
<span id="cb1-19"><a href="#cb1-19"></a>raven.p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(ME, <span class="kw">aes</span>(long,lat,<span class="dt">group=</span>subregion) )<span class="op">+</span></span>
<span id="cb1-20"><a href="#cb1-20"></a><span class="st">  </span><span class="kw">geom_polygon</span>(<span class="dt">colour =</span> <span class="st">&quot;gray&quot;</span>,<span class="dt">fill=</span><span class="st">&quot;gray90&quot;</span>)<span class="op">+</span><span class="kw">geom_point</span>(<span class="dt">data=</span>raven[[<span class="dv">2</span>]],<span class="kw">aes</span>(<span class="dt">x=</span>decimalLongitude,<span class="dt">y=</span>decimalLatitude,<span class="dt">size=</span>individualCount),<span class="dt">alpha=</span><span class="fl">0.3</span>,<span class="dt">inherit.aes =</span> F)<span class="op">+</span><span class="st"> </span><span class="kw">coord_quickmap</span>()<span class="op">+</span><span class="kw">theme_void</span>()</span>
<span id="cb1-21"><a href="#cb1-21"></a></span>
<span id="cb1-22"><a href="#cb1-22"></a><span class="co">#and add image to the map with cowplot</span></span>
<span id="cb1-23"><a href="#cb1-23"></a>raven.p2 &lt;-<span class="st"> </span><span class="kw">ggdraw</span>() <span class="op">+</span></span>
<span id="cb1-24"><a href="#cb1-24"></a><span class="st">  </span><span class="kw">draw_image</span>(<span class="st">&quot;https://www.allaboutbirds.org/guide/assets/photo/63739491-480px.jpg&quot;</span>,<span class="dt">scale =</span> <span class="fl">0.3</span>,<span class="dt">halign=</span><span class="dv">0</span>,<span class="dt">valign=</span><span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb1-25"><a href="#cb1-25"></a><span class="st">  </span><span class="kw">draw_plot</span>(raven.p)</span>
<span id="cb1-26"><a href="#cb1-26"></a><span class="kw">print</span>(raven.p2)</span></code></pre></div>
<div class="figure">
<img src="mod9_proj_files/figure-html/unnamed-chunk-1-1.png" alt="Fig. 1. Records for common raven in Maine, 2018." width="672" />
<p class="caption">
Fig. 1. Records for common raven in Maine, 2018.
</p>
</div>
<p>Notice how <code>occ_data()</code> returns records as a list of different data types. See . . .</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">names</span>(raven)</span></code></pre></div>
<pre><code>## [1] &quot;meta&quot; &quot;data&quot;</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">lapply</span>(raven,head)</span></code></pre></div>
<pre><code>## $meta
## $meta$offset
## [1] 0
## 
## $meta$limit
## [1] 200
## 
## $meta$endOfRecords
## [1] FALSE
## 
## $meta$count
## [1] 7636
## 
## 
## $data
## # A tibble: 6 x 74
##   key   scientificName decimalLatitude decimalLongitude issues datasetKey
##   &lt;chr&gt; &lt;chr&gt;                    &lt;dbl&gt;            &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;     
## 1 1831… Corvus corax …            44.4            -68.1 &quot;cdro… 50c9509d-…
## 2 2102… Corvus corax …            44.6            -69.2 &quot;&quot;     4fa7b334-…
## 3 2102… Corvus corax …            44.4            -68.0 &quot;&quot;     4fa7b334-…
## 4 2102… Corvus corax …            44.3            -68.0 &quot;&quot;     4fa7b334-…
## 5 2102… Corvus corax …            44.4            -68.4 &quot;&quot;     4fa7b334-…
## 6 2103… Corvus corax …            44.6            -69.2 &quot;&quot;     4fa7b334-…
## # … with 68 more variables: publishingOrgKey &lt;chr&gt;, installationKey &lt;chr&gt;,
## #   publishingCountry &lt;chr&gt;, protocol &lt;chr&gt;, lastCrawled &lt;chr&gt;,
## #   lastParsed &lt;chr&gt;, crawlId &lt;int&gt;, basisOfRecord &lt;chr&gt;,
## #   occurrenceStatus &lt;chr&gt;, taxonKey &lt;int&gt;, kingdomKey &lt;int&gt;, phylumKey &lt;int&gt;,
## #   classKey &lt;int&gt;, orderKey &lt;int&gt;, familyKey &lt;int&gt;, genusKey &lt;int&gt;,
## #   speciesKey &lt;int&gt;, acceptedTaxonKey &lt;int&gt;, acceptedScientificName &lt;chr&gt;,
## #   kingdom &lt;chr&gt;, phylum &lt;chr&gt;, order &lt;chr&gt;, family &lt;chr&gt;, genus &lt;chr&gt;,
## #   species &lt;chr&gt;, genericName &lt;chr&gt;, specificEpithet &lt;chr&gt;, taxonRank &lt;chr&gt;,
## #   taxonomicStatus &lt;chr&gt;, dateIdentified &lt;chr&gt;,
## #   coordinateUncertaintyInMeters &lt;dbl&gt;, stateProvince &lt;chr&gt;, year &lt;int&gt;,
## #   month &lt;int&gt;, day &lt;int&gt;, eventDate &lt;chr&gt;, modified &lt;chr&gt;,
## #   lastInterpreted &lt;chr&gt;, references &lt;chr&gt;, license &lt;chr&gt;,
## #   geodeticDatum &lt;chr&gt;, class &lt;chr&gt;, countryCode &lt;chr&gt;, country &lt;chr&gt;,
## #   rightsHolder &lt;chr&gt;, identifier &lt;chr&gt;, `http://unknown.org/nick` &lt;chr&gt;,
## #   verbatimEventDate &lt;chr&gt;, datasetName &lt;chr&gt;, verbatimLocality &lt;chr&gt;,
## #   gbifID &lt;chr&gt;, collectionCode &lt;chr&gt;, occurrenceID &lt;chr&gt;, taxonID &lt;chr&gt;,
## #   recordedBy &lt;chr&gt;, catalogNumber &lt;chr&gt;,
## #   `http://unknown.org/occurrenceDetails` &lt;chr&gt;, institutionCode &lt;chr&gt;,
## #   rights &lt;chr&gt;, eventTime &lt;chr&gt;, occurrenceRemarks &lt;chr&gt;, identifiedBy &lt;chr&gt;,
## #   identificationID &lt;chr&gt;, individualCount &lt;int&gt;, vernacularName &lt;chr&gt;,
## #   locality &lt;chr&gt;, county &lt;chr&gt;, name &lt;chr&gt;</code></pre>
<p>This includes the meta data (<code>$meta</code>), data about the data and the data themselves, (<code>$data</code>), a tibble. The <code>$data</code> tibble includes the information we need for this project, including date, lat, long, count, etc. Thus, to access the lat/lon data in our records, we refer to the second element in the list, that is <code>raven[[2]]</code>.</p>
<p>Before we get a GBIF search for TGMs started, I suggest first storing your species names in a vector (so please choose them and store them). Say, for instance, you chose great-crested flycatcher, Baltimore oriole, rose-breasted grossbeak, yellow-billed cuckoo, and black-throated blue warbler. We also want to restrict the search to spring arrival time in years of interest (i.e., those with decent eBird data . . . &gt;1990 or so). Let’s store those values, too.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>species &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Myiarchus crinitus&quot;</span>,<span class="st">&quot;Icterus galbula&quot;</span>,<span class="st">&quot;Pheucticus ludovicianus&quot;</span>,<span class="st">&quot;Coccyzus americanus&quot;</span>,<span class="st">&quot;Setophaga caerulescens&quot;</span>)</span>
<span id="cb6-2"><a href="#cb6-2"></a></span>
<span id="cb6-3"><a href="#cb6-3"></a>y &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;1990&quot;</span>,<span class="st">&quot;,&quot;</span>,<span class="st">&quot;2019&quot;</span>)</span>
<span id="cb6-4"><a href="#cb6-4"></a>m &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;3&quot;</span>,<span class="st">&quot;,&quot;</span>,<span class="st">&quot;6&quot;</span>)</span></code></pre></div>
<p>Notice how the year and month vectors, <code>y</code> and <code>m</code>, respectively, are each a character string with two values separated by a comma. This is how we’ll constrain the search with <code>occ_data()</code>. Have a look at <code>?occ_data</code> to familiarize yourself with the function’s parameters and the values they take.</p>
<p>To commence the GBIF queries for your 5 species, I suggest using a familiar convention: a <code>for</code> loop that passes data to an empty list. That is, establish that empty list and run the species through <code>occ_data()</code>, storing values in the list as the <code>for</code> loop progresses. Here are some important pieces.</p>
<p>Constrain the <code>occ_data()</code> search by:</p>
<ul>
<li>each of your species in your loop (i.e.,<code>scientificName=i</code> if <code>i</code> is your <code>for</code> variable)</li>
<li>occurrences within our year and month range (<code>year=y</code> and <code>month=m</code>)</li>
<li>occurrences in United States and the state Massachusetts (<code>country="US"</code> and <code>stateProvince="Massachusetts"</code>)</li>
<li>occurrence record should be based on a human observation, that is, someone saw this in the wild (i.e., an eBird record, <code>basisOfRecord = "HUMAN_OBSERVATION"</code>).</li>
</ul>
<p>This will be a rather labored search in that it might take 20 minutes to run through all five species, depending on the number of records. But, this is nothing like the hours one would spend working with <code>auk</code>. So run this and grab a sandwich and refresh your twitter feed. After that, we should have a many thousands of MA eBird records loaded to the list.</p>
<p>To get get you started, here’s what could be done . . .</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>dat.l &lt;-<span class="kw">list</span>()</span>
<span id="cb7-2"><a href="#cb7-2"></a></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="cf">for</span>(s <span class="cf">in</span> species){</span>
<span id="cb7-4"><a href="#cb7-4"></a>  </span>
<span id="cb7-5"><a href="#cb7-5"></a>  <span class="co">## setting the limit=0 returns no records but can give you the number of observations if you access the meta data</span></span>
<span id="cb7-6"><a href="#cb7-6"></a>n.obs &lt;-<span class="st">  </span><span class="kw">occ_data</span>(<span class="dt">scientificName =</span> s,<span class="dt">year=</span>y,<span class="dt">month=</span>m,<span class="dt">limit=</span><span class="dv">0</span>,<span class="dt">country=</span><span class="st">&quot;US&quot;</span>,<span class="dt">basisOfRecord =</span> <span class="st">&quot;HUMAN_OBSERVATION&quot;</span>,<span class="dt">stateProvince=</span><span class="st">&quot;Massachusetts&quot;</span>)<span class="op">$</span>meta<span class="op">$</span>count </span>
<span id="cb7-7"><a href="#cb7-7"></a></span>
<span id="cb7-8"><a href="#cb7-8"></a><span class="kw">print</span>(n.obs)</span>
<span id="cb7-9"><a href="#cb7-9"></a></span>
<span id="cb7-10"><a href="#cb7-10"></a></span>
<span id="cb7-11"><a href="#cb7-11"></a>dat.l[[<span class="kw">paste0</span>(s)]] &lt;-<span class="st"> </span><span class="kw">occ_data</span>(<span class="dt">scientificName =</span> s,<span class="dt">year=</span>y,<span class="dt">month=</span>m,</span>
<span id="cb7-12"><a href="#cb7-12"></a>                               <span class="dt">limit=</span>n.obs,<span class="dt">country=</span><span class="st">&quot;US&quot;</span>,</span>
<span id="cb7-13"><a href="#cb7-13"></a>                               <span class="dt">basisOfRecord =</span> <span class="st">&quot;HUMAN_OBSERVATION&quot;</span>,</span>
<span id="cb7-14"><a href="#cb7-14"></a>                               <span class="dt">stateProvince=</span><span class="st">&quot;Massachusetts&quot;</span>)[[<span class="dv">2</span>]]</span>
<span id="cb7-15"><a href="#cb7-15"></a></span>
<span id="cb7-16"><a href="#cb7-16"></a></span>
<span id="cb7-17"><a href="#cb7-17"></a>}</span>
<span id="cb7-18"><a href="#cb7-18"></a></span>
<span id="cb7-19"><a href="#cb7-19"></a>dat &lt;-<span class="st"> </span><span class="kw">rbindlist</span>(dat.l,<span class="dt">fill=</span>T)</span>
<span id="cb7-20"><a href="#cb7-20"></a></span>
<span id="cb7-21"><a href="#cb7-21"></a><span class="kw">head</span>(dat)</span></code></pre></div>
<p>Note that we store the number of observations for each species, ripped from the meta data using <code>occ_data()</code> with <code>limit=0</code>. This won’t return records, but will return the meta data. We can then pass this number to <code>limit</code> in the subsequent use of <code>occ_data</code> to bypass the limit of 500, which is the default.</p>
<div class="green">
<div class="row">
<div class="col-sm-2">
<a class="far fa-sticky-note fa-5x" style="color:#939681"></a> <!-- regular style -->
</div>
<div class="col-sm-9">
<p>This search will take a little while and we certainly don’t want to repeat it any more than we have to. If the code that runs this lengthy search is part of your markdown (and it probably should be!), simply set the chunk options to <code>cache=TRUE</code>. So set, when this chunk runs successfully, the <a href="https://yihui.org/knitr/options/#cache">results are stored (i.e., cached) so they can be accessed without running the code again</a>. The cache will be used in place of the chunk until the code within it changes. Give it a shot.</p>
</div>
</div>
</div>
<p><br></p>
<p>After a large operation like this, it’s best to save the data. Many in the R world prefer that large data objects be stored as serialized files. The <code>saveRDS()</code> function is exactly what we need for this. The following will save data as an R serialized file with the name “mass.bird.data.RDS”.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">saveRDS</span>(data,<span class="st">&quot;massbird.data.RDS&quot;</span>)</span></code></pre></div>
<p>Now, if your script or markdown should be interrupted (e.g., a crash, freeze, etc.), you can access your data with <code>readRDS()</code>:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb9-2"><a href="#cb9-2"></a>dat &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;massbird.data.RDS&quot;</span>)</span></code></pre></div>
<p>With a sense of how the bird data will be downloaded, let’s see what sort of numbers we’ll be dealing with. These are year-by-year totals from <code>occ_data()</code> searches for the 5 species above . . .</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>dat<span class="op">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="st">  </span><span class="kw">group_by</span>(year,species)<span class="op">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">count=</span><span class="kw">sum</span>(individualCount,<span class="dt">na.rm =</span> T))<span class="op">%&gt;%</span></span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>year,<span class="dt">y=</span>count,<span class="dt">col=</span>species))<span class="op">+</span><span class="kw">geom_point</span>()</span></code></pre></div>
<pre><code>## `summarise()` regrouping output by &#39;year&#39; (override with `.groups` argument)</code></pre>
<p><img src="mod9_proj_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>It looks like there’s not much data before 2000 for all species. We’ll keep this in mind as we move forward. Now let’s move on to compiling weather data.</p>
</div>
<div id="querying-noaas-ncdc-api" class="section level2">
<h2>Querying NOAA’s NCDC API</h2>
<p>First off, let’s think about what weather parameters and at which locations and time frames we’ll compile data from. We’re studying TGMs so we probably want to look at weather along the migration route. That is, weather in Massachusetts may not be the best predictor of migration timing because migrants arriving there have to fly through local weather conditions along the way.</p>
<p>Because nocturnal long-distance migrators fly about 200 km<span class="math inline">\(^{-d}\)</span> <span class="citation">(Hall-Karlsson and Fransson 2008)</span>, we can estimate that a bird that was 1000 km away from Massachusetts 5 days before arrival and 2000 km away 10 days before arrive. With this in mind, we can establish an assumed migration path from the Gulf of Mexico and sample weather from locations that are close to these distances from Massachusetts. If one draws a line from Mobile, AL on the Gulf Coast (about 2000 km from MA) to Boston, MA, Charlotte, NC sits along that line and half way along an assumed flight path (1000 km from MA). Thus, these locations represent logical sampling locations for our weather data.</p>
<p>NOAA’s NCDC identifies weather stations by unique ID codes. The following vector, <code>sts</code>, represents the codes for stations in Mobile, Charlotte, and Boston that have relatively complete data sets for wind and temperature over our time frame (&gt;1990 or so).</p>
<p>Before we start using <code>rnoaa</code> to access NOAA’s NCDC API, we have to establish a key, a token of sorts that identifies the user and establishes a connection to the NCDC servers. Head on over to <a href="https://www.ncdc.noaa.gov/cdo-web/token">this page on NOAA’s NCDC site</a> to retrieve a token. It will require entering an email address, to which the token will be sent. Copy the token (a string of random letters and numbers) and paste it into the following where “token” is indicated.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="kw">options</span>(<span class="dt">noaakey =</span> <span class="st">&quot;token&quot;</span>)</span></code></pre></div>
<p>The R function <code>options()</code> sets global parameter values for your R session. With <code>noaakey="token"</code>, you’re telling R to pass this token string to any function that asks for <code>noaakey</code>, that is, all the <code>rnoaa</code> query functions.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>sts &lt;-<span class="st"> </span><span class="kw">c</span>(</span>
<span id="cb13-2"><a href="#cb13-2"></a>  <span class="st">&quot;GHCND:USW00013894&quot;</span>, <span class="co">#Mobible, AL 2k away about 10 days away @200 km/day</span></span>
<span id="cb13-3"><a href="#cb13-3"></a>  <span class="st">&quot;GHCND:USW00013881&quot;</span>, <span class="co">#Charlotte, NC 1000 km away about 6 days away @200 km/day</span></span>
<span id="cb13-4"><a href="#cb13-4"></a>  <span class="st">&quot;GHCND:USW00014739&quot;</span> <span class="co">#Boston</span></span>
<span id="cb13-5"><a href="#cb13-5"></a>)</span></code></pre></div>
<p>Now that we have the station codes identified and a token key established, let’s query the the NCDC API with <code>ncdc_stations()</code> to retrieve their exact location. Let’s first see what this function returns using our Boston station ID.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>bos &lt;-<span class="st"> </span><span class="kw">ncdc_stations</span>(<span class="dt">stationid =</span> <span class="st">&quot;GHCND:USW00014739&quot;</span>)</span>
<span id="cb14-2"><a href="#cb14-2"></a></span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="kw">print</span>(bos)</span></code></pre></div>
<pre><code>## $meta
## NULL
## 
## $data
##   elevation    mindate    maxdate latitude          name datacoverage
## 1       3.7 1936-01-01 2020-11-22  42.3606 BOSTON, MA US            1
##                  id elevationUnit longitude
## 1 GHCND:USW00014739        METERS  -71.0097
## 
## attr(,&quot;class&quot;)
## [1] &quot;ncdc_stations&quot;</code></pre>
<p>Notice that the data about this station is stored in the <code>$data</code> table returned by <code>ncdc_stations()</code> This means we can run all three of out stations through this function and combine the rows to give us a table with all the station data. We’ll use these data to map the station locations to visualize our weather sampling locations. Let’s do that using <code>lapply()</code> and a few other tricks to prepare the station data for mapping and use with other <code>ncdc</code> functions.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>sta.d &lt;-<span class="st"> </span><span class="kw">bind_rows</span>( <span class="co">#bind the rows</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>  <span class="kw">lapply</span>(sts,<span class="cf">function</span>(x) <span class="kw">ncdc_stations</span>(<span class="dt">stationid =</span> x)<span class="op">$</span>data ) <span class="co">#use lapply to run through stations</span></span>
<span id="cb16-3"><a href="#cb16-3"></a>  )<span class="op">%&gt;%</span></span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="st">  </span><span class="kw">left_join</span>(<span class="kw">usmap_transform</span>(.[,<span class="kw">c</span>(<span class="st">&quot;longitude&quot;</span>,<span class="st">&quot;latitude&quot;</span>)]))<span class="op">%&gt;%</span><span class="st"> </span><span class="co">#join transformation of lat/long for projection with usmap</span></span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">name=</span><span class="kw">str_sub</span>(name, <span class="dv">-5</span>,<span class="op">-</span><span class="dv">4</span>))<span class="op">%&gt;%</span><span class="co">#simplify the name column, grab just the state</span></span>
<span id="cb16-6"><a href="#cb16-6"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">migr.day=</span><span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">5</span>,<span class="dv">0</span>))<span class="op">%&gt;%</span><span class="st"> </span><span class="co">#so we can look at wind speed 0, 5 or 10 days before arrive in boston</span></span>
<span id="cb16-7"><a href="#cb16-7"></a><span class="st">  </span><span class="kw">separate</span>(id,<span class="dt">into =</span> <span class="kw">c</span>(<span class="st">&quot;station.type&quot;</span>,<span class="st">&quot;id&quot;</span>))<span class="op">%&gt;%</span><span class="co">#need to cut station type out from station id number</span></span>
<span id="cb16-8"><a href="#cb16-8"></a><span class="st">        </span><span class="kw">print</span>()</span></code></pre></div>
<pre><code>##   elevation    mindate    maxdate latitude name datacoverage station.type
## 1      65.5 1948-01-01 2020-11-21 30.68833   AL            1        GHCND
## 2     221.9 1939-01-01 2020-11-21 35.22360   NC            1        GHCND
## 3       3.7 1936-01-01 2020-11-21 42.36060   MA            1        GHCND
##            id elevationUnit longitude longitude.1 latitude.1 migr.day
## 1 USW00013894        METERS -88.24556     1128546 -1510270.4       10
## 2 USW00013881        METERS -80.95520     1718207  -890715.0        5
## 3 USW00014739        METERS -71.00970     2320539   125820.5        0</code></pre>
<p>First, we surround <code>lapply()</code> with <code>dplyr</code>’s <code>bind_rows()</code> so that the results of the <code>lapply()</code> operation will be collapsed into a single table. Within <code>lapply()</code>, we have that function work on our stations vector, <code>sts</code>, using a short customized function that queries NCDC station data with <code>ncdc_stations()</code> and returns the data with <code>$data</code>.</p>
<p>Next, we join transformed lat/lon data from this table using <code>usmap_tranform()</code> from the <code>usmap</code> package. We’ll use this package to map the eastern US with our sampling locations and this package uses a funky lat/long projection We then mutate the <code>name</code> column in the table to contain just the state using <code>str_sub()</code> from the <code>stringr</code> package loaded with <code>tidyverse</code>. With <code>str_sub(name, -5,-4)</code>, we’re mutating the name to contain the characters that are the 5th through 4th from the end of the string, that is, the state. Then, we add a column that reflects the assumed migration day away from Boston (10, 5, and 0 for AL, NC, and MA, respectively). This will be important later. Lastly, we use <code>dplyr</code>’s <code>separate()</code> function to split the station ID column into two separate columns, <code>station.type</code> and <code>id</code>, essentially replacing the <code>id</code> column with the station code minus the prefix that represents station type. We’ll need station ID without this prefix for later <code>ncdc</code> operations.</p>
<p>Now let’s plot these locations on a map of the eastern US. We’ll use <code>usmap</code>’s <code>plot_usmap()</code> function for this as it plays nice with <code>ggplot</code>. <code>plot_usmap()</code> allows one to include regions of the US. For our purposes, we need the northeast, south, and east north central regions, so we pass <code>c(.northeast_region,.south_region,.east_north_central)</code> to the <code>include</code> parameter. On top of this map, we add points using our transform lat/long data in the <code>sta.d</code> tibble. Let’s make the points big and color them by name (i.e., state). Then, let’s add a label using the same color scheme and nudge the position of the lable closer to the points. Lastly, we removed the legend because, duh, the points are labeled</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="kw">plot_usmap</span>(</span>
<span id="cb18-2"><a href="#cb18-2"></a>  <span class="dt">include =</span> <span class="kw">c</span>(.northeast_region,.south_region,.east_north_central)</span>
<span id="cb18-3"><a href="#cb18-3"></a>)<span class="op">+</span><span class="kw">geom_point</span>(<span class="dt">data=</span>sta.d,<span class="kw">aes</span>(<span class="dt">x=</span>longitude<span class="fl">.1</span>,<span class="dt">y=</span>latitude<span class="fl">.1</span>,<span class="dt">col=</span>name),<span class="dt">size=</span><span class="dv">5</span>)<span class="op">+</span><span class="kw">geom_label</span>(<span class="dt">data=</span>sta.d,<span class="kw">aes</span>(<span class="dt">x=</span>longitude<span class="fl">.1</span>,<span class="dt">y=</span>latitude<span class="fl">.1</span>,<span class="dt">col=</span>name,<span class="dt">label=</span>name),<span class="dt">size=</span><span class="dv">5</span>,<span class="dt">nudge_x =</span> <span class="fl">1e6</span><span class="op">*</span><span class="fl">0.25</span>)<span class="op">+</span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<div class="figure">
<img src="mod9_proj_files/figure-html/unnamed-chunk-13-1.png" alt="Fig. 2. Weather sampling locations for this project." width="672" />
<p class="caption">
Fig. 2. Weather sampling locations for this project.
</p>
</div>
<p>Voila! Looks like our sampling locations align with a decent NE migration path. Now let’s get the weather data from these stations during the spring of the years we have decent eBird data for, since 2000 when we see an uptick in eBird data. For this we’ll use <code>meteo_pull_monitors()</code> which returns a tidy tibble. Notice we pass the <code>sta.d$id</code> column to this function and it contains the station ID without the prefix.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>weather.d &lt;-<span class="st"> </span><span class="kw">meteo_pull_monitors</span>(sta.d<span class="op">$</span>id,<span class="dt">date_min =</span> <span class="st">&quot;2000-01-01&quot;</span>)</span></code></pre></div>
<pre><code>## using cached file: /Users/biology/Library/Caches/R/noaa_ghcnd/USW00013894.dly</code></pre>
<pre><code>## date created (size, mb): 2020-11-19 12:53:52 (6.951)</code></pre>
<pre><code>## file min/max dates: 1948-01-01 / 2020-11-30</code></pre>
<pre><code>## using cached file: /Users/biology/Library/Caches/R/noaa_ghcnd/USW00013881.dly</code></pre>
<pre><code>## date created (size, mb): 2020-11-19 12:33:42 (7.552)</code></pre>
<pre><code>## file min/max dates: 1939-07-01 / 2020-11-30</code></pre>
<pre><code>## using cached file: /Users/biology/Library/Caches/R/noaa_ghcnd/USW00014739.dly</code></pre>
<pre><code>## date created (size, mb): 2020-11-17 16:40:05 (8.386)</code></pre>
<pre><code>## file min/max dates: 1936-01-01 / 2020-11-30</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="kw">head</span>(weather.d)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 39
##   id    date        awnd  fmtm  pgtm  prcp  snow  snwd  tavg  tmax  tmin  tsun
##   &lt;chr&gt; &lt;date&gt;     &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;
## 1 USW0… 2000-01-01    35  1202  1341     0     0     0   178   233   122    NA
## 2 USW0… 2000-01-02    45  1200  1157     0     0     0   189   250   128    NA
## 3 USW0… 2000-01-03    68  1140  1418     0     0     0   222   239   206    NA
## 4 USW0… 2000-01-04    50    40  1334    94     0     0   133   217    44    NA
## 5 USW0… 2000-01-05    24   104   138     0     0     0    67   133    -6    NA
## 6 USW0… 2000-01-06    13  1006  1244     0     0     0    83   161     0    NA
## # … with 27 more variables: wdf2 &lt;int&gt;, wdf5 &lt;int&gt;, wesd &lt;int&gt;, wsf2 &lt;int&gt;,
## #   wsf5 &lt;int&gt;, wt01 &lt;int&gt;, wt02 &lt;int&gt;, wt03 &lt;int&gt;, wt04 &lt;int&gt;, wt05 &lt;int&gt;,
## #   wt06 &lt;int&gt;, wt07 &lt;int&gt;, wt08 &lt;int&gt;, wt09 &lt;int&gt;, wt11 &lt;int&gt;, wt13 &lt;int&gt;,
## #   wt14 &lt;int&gt;, wt15 &lt;int&gt;, wt16 &lt;int&gt;, wt17 &lt;int&gt;, wt18 &lt;int&gt;, wt21 &lt;int&gt;,
## #   wt22 &lt;int&gt;, wv03 &lt;int&gt;, psun &lt;int&gt;, wt19 &lt;int&gt;, wt10 &lt;int&gt;</code></pre>
<p>Also notice that this produces a series of messages that indicate you’ve queried the NCDC API and downloaded cached files to a local location.</p>
<p>We’ll be looking at fourish weather parameters, the minimum and maximum temperature in tenths of <span class="math inline">\(^o\)</span>C (<code>tmin</code>), average wind velocity in m<span class="math inline">\(^{-s}\)</span> (<code>awnd</code>), and direction of fastest 2-minute wind (<code>wdf2</code>). With the weather and eBird data in place, we can move on to preparing the data for analysis and the analysis itself.</p>
</div>
<div id="data-analysis" class="section level2">
<h2>Data Analysis</h2>
<div id="preparing-ebird-data" class="section level3">
<h3>Preparing eBird Data</h3>
<p>For our analysis, we’ll compute arrival time for each species by finding the day that corresponds to when 25% of all the individuals have arrived in a given year. This means that we’ll have to find the total number of individuals that arrived over our spring time frame for each year for each species. Once we have this in place, we can model the arrival as a process that resembles are logistic curve. Logistic curves are used to describe many processes in biology that take on an S-shaped response: population and tumor growth, infectious pathogen spread in a pandemic (!), and enzyme substrate binding (e.g., Hb-O<span class="math inline">\(_2\)</span> association).</p>
<p>So let’s explore an example of the arrival as modeled logistically of one species, <em>"Myiarchus crinitus</em>, in previously a developed data set. For this and all our species we’ll use Julian day as the time variable, simply the day of the year. Let’s compute that and then . . . .</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>mc&lt;-<span class="st"> </span>dat<span class="op">%&gt;%</span></span>
<span id="cb31-2"><a href="#cb31-2"></a><span class="st">  </span><span class="kw">filter</span>(species<span class="op">==</span><span class="st">&quot;Setophaga caerulescens&quot;</span>)<span class="op">%&gt;%</span></span>
<span id="cb31-3"><a href="#cb31-3"></a><span class="st">  </span><span class="kw">group_by</span>(year)<span class="op">%&gt;%</span></span>
<span id="cb31-4"><a href="#cb31-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">date=</span><span class="kw">as.Date</span>(<span class="kw">paste0</span>(year,<span class="st">&quot;-&quot;</span>,month,<span class="st">&quot;-&quot;</span>,day)),</span>
<span id="cb31-5"><a href="#cb31-5"></a>         <span class="dt">j.day=</span><span class="kw">julian</span>(date,<span class="dt">origin=</span><span class="kw">as.Date</span>(<span class="kw">paste0</span>(<span class="kw">unique</span>(year),<span class="st">&quot;-01-01&quot;</span>)))</span>
<span id="cb31-6"><a href="#cb31-6"></a>  )<span class="op">%&gt;%</span></span>
<span id="cb31-7"><a href="#cb31-7"></a><span class="st">  </span><span class="kw">group_by</span>(species,year,j.day,date)<span class="op">%&gt;%</span></span>
<span id="cb31-8"><a href="#cb31-8"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">day.tot=</span><span class="kw">sum</span>(individualCount,<span class="dt">na.rm=</span>T))<span class="op">%&gt;%</span></span>
<span id="cb31-9"><a href="#cb31-9"></a><span class="st">  </span><span class="kw">group_by</span>(species,year)<span class="op">%&gt;%</span></span>
<span id="cb31-10"><a href="#cb31-10"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prop=</span><span class="kw">cumsum</span>(day.tot<span class="op">/</span><span class="kw">sum</span>(day.tot,<span class="dt">na.rm =</span> T)))<span class="op">%&gt;%</span></span>
<span id="cb31-11"><a href="#cb31-11"></a><span class="st">  </span><span class="kw">filter</span>(year<span class="op">&gt;</span><span class="dv">1999</span>)</span></code></pre></div>
<pre><code>## `summarise()` regrouping output by &#39;species&#39;, &#39;year&#39;, &#39;j.day&#39; (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>mc<span class="op">%&gt;%</span></span>
<span id="cb33-2"><a href="#cb33-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(j.day,prop))<span class="op">+</span><span class="kw">geom_point</span>()<span class="op">+</span><span class="kw">facet_wrap</span>(year<span class="op">~</span>.)</span></code></pre></div>
<p><img src="mod9_proj_files/figure-html/mc-1.png" width="672" /></p>
<p>So as we can see, arrival of these migrants follows a logistic process when we consider the proportion of the population that has arrived. Now we can model this with a logistic model in R. We’ll add predictions based on <code>nls()</code> and <code>SSlogis()</code> functions from the <code>stats</code> package. This is similar to something we did in the project for <a href="https://bcorgbio.github.io/class/mod3_proj.html#More_Complex_Visualizations_and_Models">Module 3</a>. A logistic model requires a few parameter: the asymptote (<code>Asym</code>), the x value (<code>j.day</code> in our case) at the inflection point of the curve (<code>xmid</code>), and the scale (<code>scale</code>). We’ll use <code>SSlogis()</code>, a self-starting model that creates initial estimates of the parameters. After modeling the logistic curves, let’s add the date back to the tibble (it’ll be important later) and then plot the predictions along with the original data.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a>mc.pred &lt;-<span class="st"> </span>mc<span class="op">%&gt;%</span></span>
<span id="cb34-2"><a href="#cb34-2"></a><span class="st">  </span><span class="kw">group_by</span>(year)<span class="op">%&gt;%</span></span>
<span id="cb34-3"><a href="#cb34-3"></a><span class="st"> </span><span class="kw">summarize</span>(</span>
<span id="cb34-4"><a href="#cb34-4"></a>   <span class="dt">pred=</span><span class="kw">predict</span>(<span class="kw">nls</span>(prop<span class="op">~</span><span class="kw">SSlogis</span>(j.day,Asym, xmid, scal)),<span class="dt">newdata=</span><span class="kw">data.frame</span>(<span class="dt">j.day=</span><span class="kw">min</span>(j.day)<span class="op">:</span><span class="kw">max</span>(j.day))),<span class="co">#predict the logistic curve for each species</span></span>
<span id="cb34-5"><a href="#cb34-5"></a>   <span class="dt">j.day=</span><span class="kw">min</span>(j.day)<span class="op">:</span><span class="kw">max</span>(j.day),</span>
<span id="cb34-6"><a href="#cb34-6"></a>  )<span class="op">%&gt;%</span></span>
<span id="cb34-7"><a href="#cb34-7"></a><span class="st">  </span><span class="kw">left_join</span>(mc<span class="op">%&gt;%</span><span class="kw">select</span>(j.day,date)) <span class="co">## add date back to tibble</span></span></code></pre></div>
<pre><code>## `summarise()` regrouping output by &#39;year&#39; (override with `.groups` argument)</code></pre>
<pre><code>## Adding missing grouping variables: `species`, `year`</code></pre>
<pre><code>## Joining, by = c(&quot;year&quot;, &quot;j.day&quot;)</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a>mc<span class="op">%&gt;%</span></span>
<span id="cb38-2"><a href="#cb38-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(j.day,prop))<span class="op">+</span><span class="kw">geom_point</span>(<span class="dt">aes=</span><span class="fl">0.3</span>)<span class="op">+</span><span class="kw">geom_line</span>(<span class="dt">data=</span>mc.pred,<span class="kw">aes</span>(<span class="dt">x=</span>j.day,<span class="dt">y=</span>pred),<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">size=</span><span class="dv">2</span>)<span class="op">+</span><span class="kw">facet_wrap</span>(year<span class="op">~</span>.)</span></code></pre></div>
<pre><code>## Warning: Ignoring unknown parameters: aes</code></pre>
<p><img src="mod9_proj_files/figure-html/logistic%20model-1.png" width="672" /></p>
<p>Seems our logistic models for arrival of this species estimate the arrival function really well. Now we’ll find the Julian day each year that is closest to 0.25 of the population arriving. Let’s also plot how this arrival day varies with year.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>mc.arrive.date &lt;-mc.pred<span class="op">%&gt;%</span></span>
<span id="cb40-2"><a href="#cb40-2"></a><span class="st">  </span><span class="kw">group_by</span>(year)<span class="op">%&gt;%</span></span>
<span id="cb40-3"><a href="#cb40-3"></a><span class="st">  </span><span class="kw">filter</span>(j.day<span class="op">==</span>j.day[<span class="kw">which.min</span>(<span class="kw">abs</span>(pred<span class="fl">-0.25</span>))])</span>
<span id="cb40-4"><a href="#cb40-4"></a></span>
<span id="cb40-5"><a href="#cb40-5"></a>mc.arrive.date<span class="op">%&gt;%</span></span>
<span id="cb40-6"><a href="#cb40-6"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(year,j.day))<span class="op">+</span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="mod9_proj_files/figure-html/mc%20arrive-1.png" width="672" /></p>
<p>Pretty variable, so maybe weather can explain this. This is but just one of five species. We’ll come back to running a similar analysis for all five at once.</p>
</div>
<div id="preparing-weather-data" class="section level3">
<h3>Preparing weather Data</h3>
<p>Now let’s prepare our weather data. This first operation is rather involved, so we’ll work through it step by step. First, we’ll have to add columns for year and Julian day so that we can later join the weather and eBird data. We’ll strip the year from the date column using <code>str_sub()</code> and then group by year to compute the Julian day, just as we did for the eBird data. We’ll also make sure that date is stored as date-class data with <code>as.Date()</code>.</p>
<p>Notice that along with computing Julian day with a <code>mutate()</code> operation, we also add columns for another date (<code>date2</code>) and new weather data columns, <code>wdir.rad</code> and <code>wvec</code>. We need to repeat the date column for a join later that allows the dates between the eBird and weather data sets to be offset by 0, 5, or 10 days according to the when we expected the birds to move through AL and NC.</p>
<p>The <code>wdir.rad</code> column computes the wind direction in radians based on <code>wdf2</code>, the wind direction for two minutes. For this, we want to scale the direction to 180<span class="math inline">\(^o\)</span>, so we take the absolute of the difference from 180 and subtract that value from 180. Then we multiply this value by <span class="math inline">\(\pi/180\)</span> to get radians. Why are we doing this? See the note below.</p>
<p>With this same mutate function, we’ll compute the wind vector by finding the <span class="math inline">\(cos\)</span> of the angle (in radians), multiplying it by wind velocity (<code>awnd</code>), and finally multiplying this value by -1. We flip the sign of the vector because wind is recorded as <em>out of</em> a direction in degrees. See the note below.</p>
<p>After this, we’ll select the weather columns we want to work with, and then join the station tibble to this weather tibble. This will add the migration timing data, that is, the <code>migr.day</code> column that specifies how far back in time to look at weather in AL and NC. Notice, using this value in another mutate, we change <code>j.day</code> to reflect this shift. That is, <code>j.day</code> for AL and NC weather will be 10 and 5 days behind the original <code>j.day</code> (the Julian day of bird arrival, too.).</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a>weather.d &lt;-<span class="st"> </span>weather.d<span class="op">%&gt;%</span></span>
<span id="cb41-2"><a href="#cb41-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">year=</span><span class="kw">as.integer</span>(<span class="kw">str_sub</span>(date,<span class="dv">1</span>,<span class="dv">4</span>)), <span class="co">#add year</span></span>
<span id="cb41-3"><a href="#cb41-3"></a>         <span class="dt">date=</span><span class="kw">as.Date</span>(date))<span class="op">%&gt;%</span></span>
<span id="cb41-4"><a href="#cb41-4"></a><span class="st">  </span><span class="kw">group_by</span>(year)<span class="op">%&gt;%</span><span class="st"> </span><span class="co">#group by year so we can compute julian day</span></span>
<span id="cb41-5"><a href="#cb41-5"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">j.day=</span><span class="kw">julian</span>(date,<span class="dt">origin=</span><span class="kw">as.Date</span>(<span class="kw">paste0</span>(<span class="kw">unique</span>(year),<span class="st">&quot;-01-01&quot;</span>))), <span class="co">#add julian day</span></span>
<span id="cb41-6"><a href="#cb41-6"></a>  <span class="dt">date2=</span>date,</span>
<span id="cb41-7"><a href="#cb41-7"></a>  <span class="dt">wdir.rad=</span>(<span class="dv">180</span><span class="op">-</span><span class="kw">abs</span>(wdf2<span class="dv">-180</span>))<span class="op">*</span>pi<span class="op">/</span><span class="dv">180</span>, <span class="co">#radians so we can use a trig function to compute wind vector, scale degrees first to 180 scale to 2x pi and subtract from 180 (wind comes out of a direction)</span></span>
<span id="cb41-8"><a href="#cb41-8"></a>  <span class="dt">wvec=</span><span class="kw">cos</span>(wdir.rad)<span class="op">*-</span><span class="dv">1</span><span class="op">*</span>awnd <span class="co"># we want a negative value for positive value for 2x pi</span></span>
<span id="cb41-9"><a href="#cb41-9"></a>  )<span class="op">%&gt;%</span><span class="st"> </span><span class="co">#store day in new column</span></span>
<span id="cb41-10"><a href="#cb41-10"></a><span class="st">  </span><span class="kw">select</span>(id,year,date2,j.day,tmin,tmax,wvec)<span class="op">%&gt;%</span><span class="st"> </span><span class="co">#select the rows we need</span></span>
<span id="cb41-11"><a href="#cb41-11"></a><span class="st">  </span><span class="kw">left_join</span>(sta.d<span class="op">%&gt;%</span><span class="kw">select</span>(id,name,migr.day))<span class="op">%&gt;%</span><span class="st"> </span><span class="co">#add the station id info (ie. name)</span></span>
<span id="cb41-12"><a href="#cb41-12"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">j.day=</span>j.day<span class="op">+</span>migr.day)<span class="co">#make j.day ahead of BOS according to the migration days away so we can join weather along path</span></span></code></pre></div>
<pre><code>## Joining, by = &quot;id&quot;</code></pre>
<div class = "green">
<div class="row">
<div class="col-sm-2">
<a class="far fa-sticky-note fa-5x" style="color:#939681"></a> <!-- regular style -->
</div>
<div class="col-sm-9">

<p>So why scale the wind direction to 180<span class="math inline">\(^o\)</span>? Because we care about the direction relative to north only and we’re going to compute a vector—this is what will matter. Have a look at these four wind directions in the table below. Two winds coming out of the north at 10 and 350<span class="math inline">\(^o\)</span> or south at 160 and 200<span class="math inline">\(^o\)</span> have the same difference from 0<span class="math inline">\(^o\)</span> or exactly north (Fig. 3:A). When transformed to a 0-180<span class="math inline">\(^o\)</span> scale and into radians, you can see from the table the values are the same within each group. Now, when multiplied by a velocity, we’ll get a vector relative to north as well. In this case, because wind direction is reported as coming from a direction in degrees (rather than toward), we’ll multiply the vector by -1 to establish a vector that, if negative, represents a head wind and, if positive, represents a tailwind (Fig. 3:B).</p>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
n
</th>
<th style="text-align:right;">
deg
</th>
<th style="text-align:right;">
deg.corr
</th>
<th style="text-align:right;">
deg.rad
</th>
<th style="text-align:right;">
velocity
</th>
<th style="text-align:right;">
wvec
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
0.1745329
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
-9.848078
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
350
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
0.1745329
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
-19.696155
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
160
</td>
<td style="text-align:right;">
160
</td>
<td style="text-align:right;">
2.7925268
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
28.190779
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
160
</td>
<td style="text-align:right;">
2.7925268
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
37.587705
</td>
</tr>
</tbody>
</table>
<img src="mod9_proj_files/figure-html/wind%20dir-1.png" width="672" />
</div>
</div>
</div>
<p><br></p>
<p>Now, with the variables we want (arrival day on the bird side, <code>tmin</code>, <code>tmax</code>, and <code>wvec</code> on the weather side), we’re ready to join eBird and weather data for analysis. To get you started, let’s join the the arrival data for <em>Myiarchus crinitis</em> with our weather data. To this tibble, we’ll also join the <code>date</code> column from the original bird data so we can see if the weather data is the right number of days behind the bird arrive date.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a>mc.arr.weath &lt;-<span class="st"> </span>mc.arrive.date<span class="op">%&gt;%</span></span>
<span id="cb43-2"><a href="#cb43-2"></a><span class="st">  </span><span class="kw">left_join</span>(weather.d)<span class="op">%&gt;%</span></span>
<span id="cb43-3"><a href="#cb43-3"></a><span class="st">  </span><span class="kw">left_join</span>(mc<span class="op">%&gt;%</span><span class="kw">select</span>(year,date,j.day))</span></code></pre></div>
<pre><code>## Joining, by = c(&quot;year&quot;, &quot;j.day&quot;)</code></pre>
<pre><code>## Adding missing grouping variables: `species`</code></pre>
<pre><code>## Joining, by = c(&quot;year&quot;, &quot;j.day&quot;, &quot;species&quot;, &quot;date&quot;)</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="kw">head</span>(mc.arr.weath)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 12
## # Groups:   year [2]
##    year  pred j.day species date       id    date2       tmin  tmax      wvec
##   &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;date&gt;     &lt;chr&gt; &lt;date&gt;     &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;
## 1  2000 0.240   129 Setoph… 2000-05-09 USW0… 2000-04-29    89   272  1.79e+ 1
## 2  2000 0.240   129 Setoph… 2000-05-09 USW0… 2000-05-04   117   250  2.10e+ 1
## 3  2000 0.240   129 Setoph… 2000-05-09 USW0… 2000-05-09    83   183 -2.45e+ 1
## 4  2001 0.260   131 Setoph… 2001-05-12 USW0… 2001-05-02   139   278  2.07e+ 1
## 5  2001 0.260   131 Setoph… 2001-05-12 USW0… 2001-05-07   122   222 -1.30e+ 1
## 6  2001 0.260   131 Setoph… 2001-05-12 USW0… 2001-05-12   167   311 -3.12e-15
## # … with 2 more variables: name &lt;chr&gt;, migr.day &lt;dbl&gt;</code></pre>
<p>Sure enough, it is: <code>date2</code> from the weather data is 10 and 5 days behind for AL and NC locations, respectively. Here we have the weather along the migration route with each of our stations and their data identified by name. But, how are we to analyze the data? Let’s think about the question (<strong>Does weather along the migration route predict arrival time?</strong>). Do we want just one day of weather at each location to predict arrival time (which the table above gives)? Let’s dive deeper into the weather data and compute the mean over two week (14 days) before a bird gets to each location. That is, at 200 km<span class="math inline">\(^d\)</span>, the table above assumes that birds don’t stop. And, they certainly do to eat and rest <span class="citation">(Moore and Kerlinger 1987)</span>.</p>
<p>So let’s assume that 5 and 10 days is the earliest they would arrive at these weather locations, but it could be two weeks earlier. If that’s the case, let’s calculate the mean of our weather variables over that time period. For this, we’ll use a group and mutate using <code>dplyr</code> and the <code>frollmean()</code> function from <code>data.table</code> package. <code>frollmean()</code> computes a rolling mean across the rows of a table, perfect for our application. We’ll use it to compute the rolling mean for our weather variables for two weeks preceding each Julian day. then join this weekly data tibble to our arrival data for subsequent analysis. When we use <code>left_join()</code>, only the Julian days in the weekly average tibble matching those in the arrival data will be kept.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a>weather.wk &lt;-weather.d <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb49-2"><a href="#cb49-2"></a><span class="st">  </span><span class="kw">group_by</span>(year,name) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb49-3"><a href="#cb49-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">wk.tmin =</span> <span class="kw">frollmean</span>(tmin, <span class="dt">n=</span><span class="dv">14</span>,<span class="dt">align=</span><span class="st">&quot;right&quot;</span>),</span>
<span id="cb49-4"><a href="#cb49-4"></a>         <span class="dt">wk.tmax =</span> <span class="kw">frollmean</span>(tmax, <span class="dt">n=</span><span class="dv">14</span>,<span class="dt">align=</span><span class="st">&quot;right&quot;</span>),</span>
<span id="cb49-5"><a href="#cb49-5"></a>         <span class="dt">wk.wvec =</span> <span class="kw">frollmean</span>(wvec, <span class="dt">n=</span><span class="dv">14</span>,<span class="dt">align=</span><span class="st">&quot;right&quot;</span>)</span>
<span id="cb49-6"><a href="#cb49-6"></a>         )<span class="op">%&gt;%</span></span>
<span id="cb49-7"><a href="#cb49-7"></a><span class="st">  </span><span class="kw">select</span>(j.day,date2,name,wk.tmin,wk.tmax,wk.wvec)</span></code></pre></div>
<pre><code>## Adding missing grouping variables: `year`</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a>mc.arr.weath2 &lt;-<span class="st"> </span>mc.arrive.date<span class="op">%&gt;%</span></span>
<span id="cb51-2"><a href="#cb51-2"></a><span class="st">  </span><span class="kw">left_join</span>(weather.wk)</span></code></pre></div>
<pre><code>## Joining, by = c(&quot;year&quot;, &quot;j.day&quot;)</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a><span class="kw">head</span>(mc.arr.weath2)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 10
## # Groups:   year [2]
##    year  pred j.day species  date       date2      name  wk.tmin wk.tmax wk.wvec
##   &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;    &lt;date&gt;     &lt;date&gt;     &lt;chr&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
## 1  2000 0.240   129 Setopha… 2000-05-09 2000-04-29 AL      119      267.  -0.141
## 2  2000 0.240   129 Setopha… 2000-05-09 2000-05-04 NC       80.9    213.  -4.96 
## 3  2000 0.240   129 Setopha… 2000-05-09 2000-05-09 MA       73.1    181.   6.16 
## 4  2001 0.260   131 Setopha… 2001-05-12 2001-05-02 AL      127.     265.   9.50 
## 5  2001 0.260   131 Setopha… 2001-05-12 2001-05-07 NC      105.     251.   1.49 
## 6  2001 0.260   131 Setopha… 2001-05-12 2001-05-12 MA      108.     244.   0.662</code></pre>
<p>Notice that <code>frollmean()</code> needs <code>n</code> specified, the number of values in adjacent rows (actually, n-1 rows) to compute the mean. We’ll also specify that the function look to the right when computing the mean, that is, each individual row and the preceding 13 rows in this case. Lastly, we chopped down the weekly average tibble to relevant columns before joining it to the arrival data.</p>
<p>With two joined tibbles each containing eBird and weather data, we’re finally ready for some analysis.</p>
</div>
</div>
<div id="linear-mixed-effect-modeling" class="section level2">
<h2>Linear Mixed-effect Modeling</h2>
<p>To evaluate the effect of weather parameters on arrival time, one could undertake analysis using simple linear models. But, we have a rather complicated data set, including parameters (i.e., covariates) we see as important and explanatory that may contribute to a slope and intercept of the model and others that may be the reason that some groups within the data set have different slopes and intercepts. The variables that contribute to the slope and intercept are termed fixed effects, while those that contribute to distinct slopes and intercepts are termed random effects, and thus an analysis that accounts for both fixed and random effects is called a mixed effect model. In our case, we are interested in how the fixed effects of temperature and wind vector explains arrival and are OK with the fact that the location of these weather variables (a random effect) may contribute differently to the relationship. <strong>In subsequent analysis, you’ll also consider species as a random effect, allowing the response of arrival time may vary according to species.</strong></p>
<p>Undertaking linear mixed-effect analysis in R is rather straightforward using the <code>lme4</code> package, specifically the <code>lme()</code> function. Any formula for <code>lme()</code> is similar to other model choices in R, except that we must specify a random effect. This takes the form of <code>+(1|variable)</code> or <code>+(y|variable)</code> where <code>variable</code> is a random effect and <code>y</code> is the response. The first of these constructions stipulates that the slope may vary according to the random effect, while the second stipulates that the slope <em>and</em> intercept may vary according to the random effect. With this in mind, let’s kick the tires on linear mixed-effects models using <code>lme()</code> with our two data tibbles, one with a single weather-day sample and another with a two week-average of the weather.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a><span class="co">#weather at 0, 5, and 10 days away from arrival</span></span>
<span id="cb55-2"><a href="#cb55-2"></a>mc.lmer &lt;-<span class="st"> </span><span class="kw">lmer</span>(j.day<span class="op">~</span>tmin<span class="op">*</span>tmax<span class="op">*</span>wvec<span class="op">+</span>(<span class="dv">1</span><span class="op">|</span>name),mc.arr.weath,<span class="dt">na.action =</span> <span class="st">&quot;na.fail&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Some predictor variables are on very different scales: consider
## rescaling</code></pre>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="kw">Anova</span>(mc.lmer) <span class="co">#Anova from the car package</span></span></code></pre></div>
<pre><code>## Analysis of Deviance Table (Type II Wald chisquare tests)
## 
## Response: j.day
##                 Chisq Df Pr(&gt;Chisq)  
## tmin           0.5729  1    0.44909  
## tmax           0.0290  1    0.86468  
## wvec           2.2213  1    0.13612  
## tmin:tmax      3.7878  1    0.05163 .
## tmin:wvec      0.1495  1    0.69898  
## tmax:wvec      0.0038  1    0.95054  
## tmin:tmax:wvec 0.3171  1    0.57334  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="co">#0Mean two week weather preceding arrival</span></span>
<span id="cb60-2"><a href="#cb60-2"></a>mc.lmer2 &lt;-<span class="st"> </span><span class="kw">lmer</span>(j.day<span class="op">~</span>wk.tmin<span class="op">*</span>wk.tmax<span class="op">*</span>wk.wvec<span class="op">+</span>(<span class="dv">1</span><span class="op">|</span>name),mc.arr.weath2,<span class="dt">na.action =</span> <span class="st">&quot;na.fail&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Some predictor variables are on very different scales: consider
## rescaling</code></pre>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a><span class="kw">Anova</span>(mc.lmer2) </span></code></pre></div>
<pre><code>## Analysis of Deviance Table (Type II Wald chisquare tests)
## 
## Response: j.day
##                          Chisq Df Pr(&gt;Chisq)  
## wk.tmin                 0.8262  1    0.36338  
## wk.tmax                 0.0000  1    0.99794  
## wk.wvec                 6.0800  1    0.01367 *
## wk.tmin:wk.tmax         4.1536  1    0.04154 *
## wk.tmin:wk.wvec         0.3236  1    0.56947  
## wk.tmax:wk.wvec         0.7507  1    0.38627  
## wk.tmin:wk.tmax:wk.wvec 1.2220  1    0.26896  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Notice that we specified the random effect of location using <code>(1|name)</code>, allowing each location to have a separate effect on the slope of the relationship between <code>j.day</code> and the weather variable, <code>tmin</code>, <code>tmax</code>, and <code>wvec</code>. Specifying a random effect on slope is usually sufficient, especially for more complicated data sets. Notice also that we included interactions between all the fixed effects with <code>*</code>. As we’ve explored before, this is a good place to start, assuming interactions. To assesses the significance of the fixed effects we’ve used the <code>Anova()</code> function from the <code>car</code> package that suits mixed-effect models. As you can see from running <code>Anova()</code> over our two models, including only one day of data at each location doesn’t reveal any significant relationships between weather and arrival day; however, an analysis including a two-week average at each location (offset to reflect the soonest a bird would leave) does reveal significant fixed effects of weather.</p>
<p>Also have a look at the interactions at the end of the anova tables. For analysis including two-weak averages of weather values, there is an important interactions between the averages for <code>tmin</code>, <code>tmax</code> and <code>mvec</code>, that is, the degree (i.e., slope) of response varies according all three weather values.</p>
<p>In keeping with one thrust of the course, any one model is just one way to explain data and, thus, we should consider other models using our model-choice framework. So let’s do that, dropping weather variables from the two-week average analysis. With three variables, we have at least 6 possible combinations when we include all the possible interactions, if we so choose. Fortunately, the <code>dredge()</code> from the <code>MuMIn</code> package allows one to decompose a model to all the combinations of the terms, including interactions, and report important model fit values (e.g., AICc, <span class="math inline">\(\Delta\)</span>AIC, and AIC<span class="math inline">\(_w\)</span>). We’ll ask <code>dredge()</code> to consider the our weather variables only with <code>fixed= c("wk.tmin","wk.tmax","wk.wvec")</code>.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a>mc.arr.aic &lt;-<span class="st"> </span><span class="kw">dredge</span>(mc.lmer2,<span class="dt">fixed =</span> <span class="kw">c</span>(<span class="st">&quot;wk.tmin&quot;</span>,<span class="st">&quot;wk.tmax&quot;</span>,<span class="st">&quot;wk.wvec&quot;</span>),)</span>
<span id="cb65-2"><a href="#cb65-2"></a></span>
<span id="cb65-3"><a href="#cb65-3"></a>mc.kb &lt;-<span class="st"> </span><span class="kw">kable</span>(mc.arr.aic[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,],<span class="dt">caption =</span> <span class="st">&quot;Fit values for nested models of the most complicated lme model&quot;</span>)</span>
<span id="cb65-4"><a href="#cb65-4"></a></span>
<span id="cb65-5"><a href="#cb65-5"></a><span class="kw">kable_styling</span>(mc.kb)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
Fit values for nested models of the most complicated lme model
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
(Intercept)
</th>
<th style="text-align:right;">
wk.tmax
</th>
<th style="text-align:right;">
wk.tmin
</th>
<th style="text-align:right;">
wk.wvec
</th>
<th style="text-align:right;">
wk.tmax:wk.tmin
</th>
<th style="text-align:right;">
wk.tmax:wk.wvec
</th>
<th style="text-align:right;">
wk.tmin:wk.wvec
</th>
<th style="text-align:right;">
wk.tmax:wk.tmin:wk.wvec
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
logLik
</th>
<th style="text-align:right;">
AICc
</th>
<th style="text-align:right;">
delta
</th>
<th style="text-align:right;">
weight
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
129.1317
</td>
<td style="text-align:right;">
-0.0040220
</td>
<td style="text-align:right;">
0.0168047
</td>
<td style="text-align:right;">
-0.0503748
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
-121.3847
</td>
<td style="text-align:right;">
256.3543
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:right;">
0.9960437880
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
142.8859
</td>
<td style="text-align:right;">
-0.0495030
</td>
<td style="text-align:right;">
-0.1604163
</td>
<td style="text-align:right;">
-0.0560965
</td>
<td style="text-align:right;">
0.0006223
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
-125.9679
</td>
<td style="text-align:right;">
268.0897
</td>
<td style="text-align:right;">
11.73545
</td>
<td style="text-align:right;">
0.0028181084
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:right;">
129.4436
</td>
<td style="text-align:right;">
0.0000252
</td>
<td style="text-align:right;">
0.0046528
</td>
<td style="text-align:right;">
-0.1293820
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.0007193
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
-127.2022
</td>
<td style="text-align:right;">
270.5582
</td>
<td style="text-align:right;">
14.20393
</td>
<td style="text-align:right;">
0.0008202269
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
129.1845
</td>
<td style="text-align:right;">
-0.0033466
</td>
<td style="text-align:right;">
0.0146545
</td>
<td style="text-align:right;">
-0.0773914
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.0001241
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
-128.1501
</td>
<td style="text-align:right;">
272.4540
</td>
<td style="text-align:right;">
16.09977
</td>
<td style="text-align:right;">
0.0003178767
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a>best.lmer &lt;-<span class="st">  </span><span class="kw">lmer</span>(j.day<span class="op">~</span>wk.tmin<span class="op">+</span>wk.tmax<span class="op">+</span>wk.wvec<span class="op">+</span>(<span class="dv">1</span><span class="op">|</span>name),mc.arr.weath2,<span class="dt">na.action =</span> <span class="st">&quot;na.fail&quot;</span>)</span>
<span id="cb66-2"><a href="#cb66-2"></a></span>
<span id="cb66-3"><a href="#cb66-3"></a><span class="kw">Anova</span>(best.lmer)</span></code></pre></div>
<pre><code>## Analysis of Deviance Table (Type II Wald chisquare tests)
## 
## Response: j.day
##          Chisq Df Pr(&gt;Chisq)  
## wk.tmin 1.2920  1    0.25568  
## wk.tmax 0.1932  1    0.66023  
## wk.wvec 4.6570  1    0.03093 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Notice how <code>dredge()</code> return the ranks of the nested models according to AIC metrics and that the interactions columns (all with “:” between the terms) return <code>NA</code>, meaning they are not included in the best-fit model. So our best-fit model was <code>j.day~wk.tmin+wk.tmax+wk.wvec+(1|name)</code>. The last few lines of this run that model and report the anova results.</p>
<p>To sum up this quick exploration of linear-mixed effects modeling for this one species, a model that includes minimum and maximum temperature and wind vector explains the data best and minimum temperature and wind vector are significant predictors.</p>
</div>
<div id="additional-operations-and-analyses" class="section level2">
<h2>Additional Operations and Analyses</h2>
<p>Your task is to repeat data compilation and analysis for five species of your choosing from this <a href="tgms.csv">list of TGMs</a>. The analysis should include the following components:</p>
<ol style="list-style-type: decimal">
<li>A <code>for</code> loop that passes your five species through <code>occ_data()</code> to retrieve occurrence data in MA during April and May in the years 2000-2019.</li>
<li>Logistic modeling operations to predict arrival time (the Julian day when 25% of the population arrives) for each year and for each species.</li>
<li>Operations that join offset single-day and two-week weather averages with your occurrence data. Both weather data sets should include minimum and maximum temperature and wind vectors (this will require operations on the weather data before these joins).</li>
<li>Linear mixed-effect modeling of arrival day as it varies with these weather variables for both weather data sets (single-day and two-week average)</li>
<li>Model-testing operations of both data sets using <code>dredge()</code>.</li>
<li>Anova testing of the best-fit models from both data sets.</li>
</ol>
</div>
</div>
<div id="project-report" class="section level1">
<h1>Project Report</h1>
<p>Please submit your report to your team GitHub repository as an .Rmd document with HTML output that addresses the following questions:</p>
<ol style="list-style-type: decimal">
<li>Does arrival time vary according to temperature and wind variables along migration route for TGMs migrating to MA?</li>
<li>If arrival time does vary with meteorological conditions, what role will climate change potentially play in the population status of TGMs arriving in MA during the spring?</li>
<li>How does your analysis contribute to, challenge, or refine previous hypothesis concerning the role that climatic variables play in long-distance migration in passerine birds?</li>
</ol>
<p>In answering these questions, be sure to use the visualization, modeling, and model-assessments tools we’ve used in the course so far.</p>
<p>The answers and narrative in your .Rmd should include the following components:</p>
<ul>
<li>A YAML header that specifies HTML output, the authors, and a bibliography named “BIOL3140.bib”. <strong>Submit this bibliography as well!</strong>
<ul>
<li>Sections including an introduction, methods, results, discussion, author contributions, and references. Make sure that each, aside from the references, includes one to two short paragraphs. Specifically:
<ul>
<li>Introduction: Frame the questions, indicating why they are important, what background work has been done in this realm, and how you will answer them. <strong>Please include at one reference to support the summary of previous work.</strong> Note: this can be done easily by refiguring the introduction to this project report.</li>
<li>Methods: Explicitly state how you answered the questions, including a narrative of all the analyses both qualitative and quantitative.</li>
<li>Results: Include any appropriate figures or tables and a narrative of the main results that are important to answering the questions.</li>
<li>Discussion: Succinctly declare how the results relate to the question and how they compare to previous work devoted to the topic. In addition, be sure to comment on the importance of your findings to the broader topic at hand. <strong>Please include at least two references to other relevant studies.</strong> Note: circling back to the introduction will be helpful here.</li>
<li>Author contributions: Briefly outline what each team member contributed to the project.</li>
</ul></li>
</ul></li>
</ul>
</div>
<div id="references" class="section level1 unnumbered">
<h1>References</h1>
<div id="refs" class="references">
<div id="ref-askeyev2009earliest">
<p>Askeyev, Oleg V, Tim H Sparks, and Igor V Askeyev. 2009. “Earliest Recorded Tatarstan Skylark in 2008: Non-Linear Response to Temperature Suggests Advances in Arrival Dates May Accelerate.” <em>Climate Research</em> 38 (3): 189–92.</p>
</div>
<div id="ref-both2006climate">
<p>Both, Christiaan, Sandra Bouwhuis, CM Lessells, and Marcel E Visser. 2006. “Climate Change and Population Declines in a Long-Distance Migratory Bird.” <em>Nature</em> 441 (7089): 81–83.</p>
</div>
<div id="ref-hall2008far">
<p>Hall-Karlsson, K Susanna S, and Thord Fransson. 2008. “How Far Do Birds Fly During One Migratory Flight Stage?” <em>Ringing &amp; Migration</em> 24 (2): 95–100.</p>
</div>
<div id="ref-knudsen2011challenging">
<p>Knudsen, Endre, Andreas Lindén, Christiaan Both, Niclas Jonzén, Francisco Pulido, Nicola Saino, William J Sutherland, et al. 2011. “Challenging Claims in the Study of Migratory Birds and Climate Change.” <em>Biological Reviews</em> 86 (4): 928–46.</p>
</div>
<div id="ref-moore1987stopover">
<p>Moore, Frank, and Paul Kerlinger. 1987. “Stopover and Fat Deposition by North American Wood-Warblers (Parulinae) Following Spring Migration over the Gulf of Mexico.” <em>Oecologia</em> 74 (1): 47–54.</p>
</div>
<div id="ref-newton2008ecology">
<p>Newton, I. 2008. <em>The Ecology of Bird Migration</em>. Academic Press, London.</p>
</div>
<div id="ref-smith2005arrival">
<p>Smith, Robert J, and Frank R Moore. 2005. “Arrival Timing and Seasonal Reproductive Performance in a Long-Distance Migratory Landbird.” <em>Behavioral Ecology and Sociobiology</em> 57 (3): 231–39.</p>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
